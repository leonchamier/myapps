
<!DOCTYPE html>
<html>
    <head>
    <title>ADVANTUM</title>
<script type='text/JavaScript' src='standardjs.js'></script>
<script type='text/JavaScript' src='standardsq.js'></script>
<script type="text/JavaScript" src="startup.js"></script>

    <script type="text/javascript" charset="utf-8" src="cordova.js"></script>

    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.0a2/jquery.mobile-1.0a2.min.css" />
    <script src="http://code.jquery.com/jquery-1.4.4.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.0a2/jquery.mobile-1.0a2.min.js"></script>

</head>
 
<body >
 
    <script>
    
    var pictureSource;   // picture source
    var destinationType; // sets the format of returned value 

    // Wait for PhoneGap to connect with the device
    //
    document.addEventListener("deviceready",onDeviceReady,false);

    function onDeviceReady() {
        pictureSource=navigator.camera.PictureSourceType;
        destinationType=navigator.camera.DestinationType;
    }


    function scanNow(){
	   cordova.plugins.barcodeScanner.scan(
         function (result) {
                 alert("We got a barcode\n" +
                "Result: " + result.text + "\n" +
                "Format: " + result.format + "\n" +
                "Cancelled: " + result.cancelled);
		  }, 
		  function (error) {
			  alert("Scanning failed: " + error);
		  }
   	    );
	}


 //***************************************************
 //*************PHOTO*****************************
 //***********************************************
 
     function onPhotoDataSuccess(imageData) {
      // Uncomment to view the base64 encoded image data
      // console.log(imageData);

      // Get image handlefgggggg
      //
      var smallImage = document.getElementById('smallImage');

      // Unhide image elements
      //
      smallImage.style.display = 'block';

      // Show the captured photo
      // The inline CSS rules are used to resize the image
      //
      smallImage.src = "data:image/jpeg;base64," + imageData;
      alert(smallImage.src );
      var largeImage = document.getElementById('largeImage');

      largeImage.style.display = 'block';

      largeImage.src = imageData;
      uploadPhoto(imageData);
    } 
  
   function uploadPhoto(imageURI) {
        var options = new FileUploadOptions();
        options.fileKey="file";
	options.fileName=imageURI.substr(imageURI.lastIndexOf('/')+1);
	options.mimeType="image/jpeg";
	var params = new Object();
	params.img = "test1";
	params.value2 = "param";
	options.params = params;
	options.chunkedMode = false;
	var ft = new FileTransfer();
	ft.upload(imageURI, "http://192.168.9.84/myapps/upload.php", win, fail, options);
	alert('up load success');
}


    // Called when a photo is successfully retrieved
    
    function capturePhoto() {
      // Take picture using device camera and retrieve image as base64-encoded string
      navigator.camera.getPicture(onPhotoDataSuccess, onFail, { quality: 50 });
    }

    // A button will call this function
    //
    function capturePhotoEdit() {
      // Take picture using device camera, allow edit, and retrieve image as base64-encoded string  
	  
      navigator.camera.getPicture(onPhotoDataSuccess, onFail, { quality: 20, allowEdit: true }); 
    }

    

    // Called if something bad happens.
    // 
    function onFail(message) {
      alert('Failed because: ' + message);
    }

    </script>
 
    <div data-role="page" id="indexPage">
        <div data-role="header">
            <h1>ADVANTUM inc</h1>
        </div>
    
       

        <div data-role="button" onclick="scanNow()">Scan Now </div>



           <input  type="button" data-icon="arrow-r"    value="Take A Pic" onclick="capturePhotoEdit();"/>
    
    
    <img style="display:none;width:60px;height:60px;" id="smallImage" src="" />
    <img style="display:none;" id="largeImage" src="" />

        <div data-role="footer" data-position="fixed">
            <h1>Scan Test</h1>
        </div>
    </div>
 



</body>
</html>
